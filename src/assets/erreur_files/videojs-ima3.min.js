/*! @name @brightcove/videojs-ima3 @version 5.2.8 @license UNLICENSED */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).videojs)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=t(e),n="7.3.5";
/*! @name videojs-contrib-ads @version 7.3.5 @license Apache-2.0 */var i=function(e,t){t.isImmediatePropagationStopped=function(){return!0},t.cancelBubble=!0,t.isPropagationStopped=function(){return!0}},o=function(e,t,a){i(0,a),e.trigger({type:t+a.type,originalEvent:a})};function r(e){"playing"===e.type?function(e,t){e.ads.isInAdMode()&&(e.ads.isContentResuming()?e.ads._contentEnding&&o(e,"content",t):o(e,"ad",t))}(this,e):"ended"===e.type?function(e,t){e.ads.isInAdMode()?e.ads.isContentResuming()?(i(0,t),e.trigger("resumeended")):o(e,"ad",t):e.ads._contentHasEnded||e.ads.stitchedAds()||(o(e,"content",t),e.trigger("readyforpostroll"))}(this,e):"loadstart"===e.type||"loadeddata"===e.type||"loadedmetadata"===e.type?function(e,t){if(!("loadstart"===t.type&&!e.ads._hasThereBeenALoadStartDuringPlayerLife||"loadeddata"===t.type&&!e.ads._hasThereBeenALoadedData||"loadedmetadata"===t.type&&!e.ads._hasThereBeenALoadedMetaData))if(e.ads.inAdBreak())o(e,"ad",t);else{if(e.currentSrc()!==e.ads.contentSrc)return;o(e,"content",t)}}(this,e):"play"===e.type?function(e,t){e.ads.inAdBreak()?o(e,"ad",t):e.ads.isContentResuming()&&o(e,"content",t)}(this,e):this.ads.isInAdMode()&&(this.ads.isContentResuming()?o(this,"content",e):o(this,"ad",e))}function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},d.apply(this,arguments)}function s(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t)}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}var u={},c=function(){!function(e){if(a.default.dom.isInFrame()&&"function"!=typeof window.__tcfapi){for(var t,n=window,i={};n;){try{if(n.frames.__tcfapiLocator){t=n;break}}catch(e){}if(n===window.top)break;n=n.parent}if(!t)return;window.__tcfapi=function(e,a,n,o){var r=Math.random()+"",d={__tcfapiCall:{command:e,parameter:o,version:a,callId:r}};i[r]=n,t.postMessage(d,"*")},window.addEventListener("message",(function(e){var t={};try{t="string"==typeof e.data?JSON.parse(e.data):e.data}catch(e){}var a=t.__tcfapiReturn;a&&"function"==typeof i[a.callId]&&(i[a.callId](a.returnValue,a.success),i[a.callId]=null)}),!1)}}(),"function"==typeof window.__tcfapi&&window.__tcfapi("addEventListener",2,(function(e,t){t&&(u=e)}))},g="",m=function(e,t){if(void 0===t&&(t=window),t.__uspapi)t.__uspapi("getUSPData",1,(function(t,a){var n=a?t.uspString:null;g=n,e(n)}));else{var a=function(e){for(var t=e.parent;t!==e.top;){try{if(t.frames&&t.frames.__uspapiLocator)return t}catch(e){}t=t.parent}try{if(e.top.frames&&e.top.frames.__uspapiLocator)return e.top}catch(e){}return null}(t);if(!a)return void e(null);var n=Math.random().toString(36).substring(2),i={__uspapiCall:{command:"getUSPData",version:1,callId:n}};t.addEventListener("message",(function a(i){if(i&&i.data&&i.data.__uspapiReturn&&i.data.__uspapiReturn.callId===n){t.removeEventListener("message",a,!1);var o=i.data.__uspapiReturn,r=o.returnValue,d=o.success?r.uspString:null;g=d,e(d)}}),!1),a.postMessage(i,"*")}},p=function(e,t){return t?encodeURIComponent(e):e},f=function(e,t){var a={};return["description","tags","reference_id","ad_keys"].forEach((function(n){e&&e[n]?a["{mediainfo."+n+"}"]=e[n]:t["{mediainfo."+n+"}"]?a["{mediainfo."+n+"}"]=t["{mediainfo."+n+"}"]:a["{mediainfo."+n+"}"]=""})),["custom_fields","customFields"].forEach((function(t){!function(e,t,a){if(e&&e[a])for(var n=e[a],i=Object.keys(n),o=0;o<i.length;o++)t["{mediainfo."+a+"."+i[o]+"}"]=n[i[o]]}(e,a,t)})),a},h=function(e,t,n,i){for(var o in void 0===i&&(i={}),t){var r=i.hasOwnProperty(o)?i[o]:o;if(r.startsWith("r:"))try{var d=new RegExp(r.slice(2),"g");e=e.replace(d,p(t[o],n))}catch(e){a.default.log.warn('Unable to replace macro with regex "'+r+'". The provided regex may be invalid.')}else e=e.split(r).join(p(t[o],n))}return e};function y(e,t,n){void 0===t&&(t=!1),void 0===n&&(n={});var i=n.disableDefaultMacros||!1,o=n.macroNameOverrides||{};delete n.disableDefaultMacros,delete n.macroNameOverrides;var r=n;if(i)return h(e,r,t,o);var s,l,c,m=function(e){var t={},a=e.replace(/{([^}=]+)=([^}]*)}/g,(function(e,a,n){return t["{"+a+"}"]=n,"{"+a+"}"}));return{defaults:t,modifiedString:a}}(e),p=m.defaults,y=m.modifiedString;for(var v in e=y,d(r,{"{player.id}":(c=this).options_["data-player"]||c.id_,"{player.height}":c.currentHeight(),"{player.width}":c.currentWidth(),"{player.heightInt}":Math.round(c.currentHeight()),"{player.widthInt}":Math.round(c.currentWidth()),"{player.autoplay}":c.autoplay()?1:0,"{player.muted}":c.muted()?1:0,"{player.language}":c.language()||"","{mediainfo.id}":c.mediainfo?c.mediainfo.id:"","{mediainfo.name}":c.mediainfo?c.mediainfo.name:"","{mediainfo.duration}":c.mediainfo?c.mediainfo.duration:"","{player.duration}":c.duration(),"{player.durationInt}":Math.round(c.duration()),"{player.live}":c.duration()===1/0?1:0,"{player.pageUrl}":a.default.dom.isInFrame()?document.referrer:window.location.href,"{playlistinfo.id}":c.playlistinfo?c.playlistinfo.id:"","{playlistinfo.name}":c.playlistinfo?c.playlistinfo.name:"","{timestamp}":(new Date).getTime(),"{document.referrer}":document.referrer,"{window.location.href}":window.location.href,"{random}":Math.floor(1e12*Math.random())},f(this.mediainfo,p),(s=u,l={},Object.keys(s).forEach((function(e){l["{tcf."+e+"}"]=s[e]})),l["{tcf.gdprAppliesInt}"]=s.gdprApplies?1:0,l),{"{usp.uspString}":g},function(e,t,n){var i=new RegExp("{pageVariable\\.([^}]+)}","g"),o={},r=(e.match(i)||[]).concat(Object.keys(n).filter((function(t){return i.test(t)&&e.includes(n[t])})));if(r)return r.forEach((function(e){for(var n,i=e,r=e.slice(14,-1),d=r.split("."),s=window,l=0;l<d.length;l++)if(l===d.length-1)n=s[d[l]];else if(void 0===(s=s[d[l]]))break;var u=typeof n;null===n?o[i]="null":void 0===n?t[i]?o[i]=t[i]:(a.default.log.warn('Page variable "'+r+'" not found'),o[i]=""):"string"!==u&&"number"!==u&&"boolean"!==u?(a.default.log.warn('Page variable "'+r+'" is not a supported type'),o[i]=""):o[i]=n})),o}(e,p,o)),e=h(e,r,t,o),p)e=e.replace(v,p[v]);return e}var v={processMetadataTracks:function(e,t){for(var a=e.textTracks(),n=function(a){"metadata"===a.kind&&(e.ads.cueTextTracks.setMetadataTrackMode(a),t(e,a))},i=0;i<a.length;i++)n(a[i]);a.addEventListener("addtrack",(function(e){n(e.track)}))},setMetadataTrackMode:function(e){},getSupportedAdCue:function(e,t){return t},isSupportedAdCue:function(e,t){return!0},getCueId:function(e,t){return t.id}},A=function(e,t){return void 0!==t&&e.ads.includedCues[t]},S=function(e,t){void 0!==t&&""!==t&&(e.ads.includedCues[t]=!0)};function C(){!1!==this.ads._shouldBlockPlay&&(this.paused()||(this.ads.debug("Playback was canceled by cancelContentPlay"),this.pause()),this.ads._cancelledPlay=!0)}v.processAdTrack=function(e,t,n,i){e.ads.includedCues={};for(var o=0;o<t.length;o++){var r=t[o],d=this.getSupportedAdCue(e,r);if(!this.isSupportedAdCue(e,r))return void a.default.log.warn("Skipping as this is not a supported ad cue.",r);var s=this.getCueId(e,r),l=r.startTime;if(A(e,s))return void a.default.log("Skipping ad already seen with ID "+s);i&&i(e,d,s,l),n(e,d,s,l),S(e,s)}};var _={},M=a.default;_.isMiddlewareMediatorSupported=function(){return!M.browser.IS_IOS&&!M.browser.IS_ANDROID&&!!(M.use&&M.middleware&&M.middleware.TERMINATOR)},_.playMiddleware=function(e){return{setSource:function(e,t){t(null,e)},callPlay:function(){if(e.ads&&!0===e.ads._shouldBlockPlay)return e.ads.debug("Using playMiddleware to block content playback"),e.ads._playBlocked=!0,M.middleware.TERMINATOR},play:function(t,n){e.ads&&e.ads._playBlocked&&t?(e.ads.debug("Play call to Tech was terminated."),e.trigger("play"),e.addClass("vjs-has-started"),e.ads._playBlocked=!1):n&&n.catch&&n.catch((function(t){"NotAllowedError"!==t.name||a.default.browser.IS_SAFARI||e.trigger("pause")}))}}},_.testHook=function(e){M=e};var b=_.playMiddleware,P=_.isMiddlewareMediatorSupported;var R=function(){function e(){}return e.getState=function(t){if(t)return e.states_&&e.states_[t]?e.states_[t]:void 0},e.registerState=function(t,a){if("string"!=typeof t||!t)throw new Error('Illegal state name, "'+t+'"; must be a non-empty string.');return e.states_||(e.states_={}),e.states_[t]=a,a},e}(),k=function(){function e(e){this.player=e}e._getName=function(){return"Anonymous State"};var t=e.prototype;return t.transitionTo=function(e){var t=this.player;this.cleanup(t);var a=new e(t);t.ads._state=a,t.ads.debug(this.constructor._getName()+" -> "+a.constructor._getName());for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];a.init.apply(a,[t].concat(i))},t.init=function(){},t.cleanup=function(){},t.onPlay=function(){},t.onPlaying=function(){},t.onEnded=function(){},t.onAdEnded=function(){},t.onAdsReady=function(){a.default.log.warn("Unexpected adsready event")},t.onAdsError=function(){},t.onAdsCanceled=function(){},t.onAdTimeout=function(){},t.onAdStarted=function(){},t.onAdSkipped=function(){},t.onContentChanged=function(){},t.onContentResumed=function(){},t.onReadyForPostroll=function(){a.default.log.warn("Unexpected readyforpostroll event")},t.onNoPreroll=function(){},t.onNoPostroll=function(){},t.startLinearAdMode=function(){a.default.log.warn("Unexpected startLinearAdMode invocation (State via "+this.constructor._getName()+")")},t.endLinearAdMode=function(){a.default.log.warn("Unexpected endLinearAdMode invocation (State via "+this.constructor._getName()+")")},t.skipLinearAdMode=function(){a.default.log.warn("Unexpected skipLinearAdMode invocation (State via "+this.constructor._getName()+")")},t.isAdState=function(){throw new Error("isAdState unimplemented for "+this.constructor._getName())},t.isWaitingForAdBreak=function(){return!1},t.isContentResuming=function(){return!1},t.inAdBreak=function(){return!1},t.handleEvent=function(e){var t=this.player;"play"===e?this.onPlay(t):"adsready"===e?this.onAdsReady(t):"adserror"===e?this.onAdsError(t):"adscanceled"===e?this.onAdsCanceled(t):"adtimeout"===e?this.onAdTimeout(t):"ads-ad-started"===e?this.onAdStarted(t):"ads-ad-skipped"===e?this.onAdSkipped(t):"contentchanged"===e?this.onContentChanged(t):"contentresumed"===e?this.onContentResumed(t):"readyforpostroll"===e?this.onReadyForPostroll(t):"playing"===e?this.onPlaying(t):"ended"===e?this.onEnded(t):"nopreroll"===e?this.onNoPreroll(t):"nopostroll"===e?this.onNoPostroll(t):"adended"===e&&this.onAdEnded(t)},e}();R.registerState("State",k);var T=function(e){function t(t){var a;return(a=e.call(this,t)||this).contentResuming=!1,a.waitingForAdBreak=!1,a}s(t,e);var a=t.prototype;return a.isAdState=function(){return!0},a.onPlaying=function(){var e=R.getState("ContentPlayback");this.contentResuming&&this.transitionTo(e)},a.onContentResumed=function(){var e=R.getState("ContentPlayback");this.contentResuming&&this.transitionTo(e)},a.isWaitingForAdBreak=function(){return this.waitingForAdBreak},a.isContentResuming=function(){return this.contentResuming},a.inAdBreak=function(){return!0===this.player.ads._inLinearAdMode},t}(k);R.registerState("AdState",T);var w=function(e){function t(){return e.apply(this,arguments)||this}s(t,e);var a=t.prototype;return a.isAdState=function(){return!1},a.onContentChanged=function(e){var t=R.getState("BeforePreroll"),a=R.getState("Preroll");e.ads.debug("Received contentchanged event (ContentState)"),e.paused()?this.transitionTo(t):(this.transitionTo(a,!1),e.pause(),e.ads._pausedOnContentupdate=!0)},t}(k);R.registerState("ContentState",w);var I,E=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"AdsDone"};var n=t.prototype;return n.init=function(e){e.ads._contentHasEnded=!0,e.trigger("ended")},n.startLinearAdMode=function(){a.default.log.warn("Unexpected startLinearAdMode invocation (AdsDone)")},t}(R.getState("ContentState"));R.registerState("AdsDone",E);var L={start:function(e){e.ads.debug("Starting ad break"),e.ads._inLinearAdMode=!0,e.trigger("adstart"),e.ads.shouldTakeSnapshots()&&(e.ads.snapshot=function(e){var t;t=a.default.browser.IS_IOS&&e.ads.isLive(e)&&e.seekable().length>0?e.currentTime()-e.seekable().end(0):e.currentTime();var n=e.$(".vjs-tech"),i=e.textTracks?e.textTracks():[],o=[],r={ended:e.ended(),currentSrc:e.currentSrc(),sources:e.currentSources(),src:e.tech_.src(),currentTime:t,type:e.currentType()};n&&(r.style=n.getAttribute("style"));for(var d=0;d<i.length;d++){var s=i[d];o.push({track:s,mode:s.mode}),s.mode="disabled"}return r.suppressedTracks=o,r}(e)),e.ads.shouldPlayContentBehindAd(e)&&!e.ads.settings.stitchedAds&&(e.ads.preAdVolume_=e.volume(),e.volume(0)),e.addClass("vjs-ad-playing"),e.hasClass("vjs-live")&&e.removeClass("vjs-live"),e.ads.removeNativePoster(),e.ads.preAdPlaybackRate_=e.playbackRate(),e.playbackRate(1),e.controlBar&&e.controlBar.playbackRateMenuButton&&e.controlBar.playbackRateMenuButton.playbackRateSupported&&!e.controlBar.playbackRateMenuButton.hasClass("vjs-hidden")?(e.controlBar.playbackRateMenuButton.hide(),e.ads.showPlaybackMenuOnAdEnd_=!0):e.ads.showPlaybackMenuOnAdEnd_=!1},end:function(e,t){e.ads.debug("Ending ad break"),void 0===t&&(t=function(){}),e.ads.adType=null,e.ads._inLinearAdMode=!1,e.trigger("adend"),e.removeClass("vjs-ad-playing"),e.ads.isLive(e)&&e.addClass("vjs-live"),e.ads.shouldTakeSnapshots()?function(e,t){var n=e.ads.snapshot;if(void 0===t&&(t=function(){}),!0===e.ads.disableNextSnapshotRestore)return e.ads.disableNextSnapshotRestore=!1,delete e.ads.snapshot,void t();var i,o=e.$(".vjs-tech"),r=20,d=n.suppressedTracks,s=function(){for(var e=0;e<d.length;e++)(i=d[e]).track.mode=i.mode},l=function(){var t;if(a.default.browser.IS_IOS&&e.ads.isLive(e)){if(n.currentTime<0&&(t=e.seekable().length>0?e.seekable().end(0)+n.currentTime:e.currentTime(),e.currentTime(t)),e.paused()){var i=e.play();i&&i.catch&&i.catch((function(e){a.default.log.warn("Play promise rejected in IOS snapshot resume",e)}))}}else if(n.ended)e.currentTime(e.duration());else{e.currentTime(n.currentTime);var o=e.play();o&&o.catch&&o.catch((function(e){a.default.log.warn("Play promise rejected in snapshot resume",e)}))}e.ads.shouldRemoveAutoplay_&&(e.autoplay(!1),e.ads.shouldRemoveAutoplay_=!1)},u=function t(){if(e.off("contentcanplay",t),I&&e.clearTimeout(I),(o=e.el().querySelector(".vjs-tech")).readyState>1)return l();if(void 0===o.seekable)return l();if(o.seekable.length>0)return l();if(r--)e.setTimeout(t,50);else try{l()}catch(e){a.default.log.warn("Failed to resume the content after an advertisement",e)}};if("style"in n&&o.setAttribute("style",n.style||""),e.ads.videoElementRecycled())e.one("resumeended",(function(){delete e.ads.snapshot,t()})),e.one("contentloadedmetadata",s),a.default.browser.IS_IOS&&!e.autoplay()&&"function"==typeof e.techCall_&&(e.techCall_("setAutoplay",!0),e.ads.shouldRemoveAutoplay_=!0),e.src(n.sources),e.one("contentcanplay",u),I=e.setTimeout(u,2e3);else{if(s(),!e.ended()){var c=e.play();c&&c.catch&&c.catch((function(e){a.default.log.warn("Play promise rejected in snapshot restore",e)}))}delete e.ads.snapshot,t()}}(e,t):(e.ads.preAdVolume_&&e.volume(e.ads.preAdVolume_),t()),e.playbackRate(e.ads.preAdPlaybackRate_),e.ads.showPlaybackMenuOnAdEnd_&&e.controlBar.playbackRateMenuButton.show()}},B=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"Preroll"};var n=t.prototype;return n.init=function(e,t,a){if(this.waitingForAdBreak=!0,e.addClass("vjs-ad-loading"),a||e.ads.nopreroll_)return this.resumeAfterNoPreroll(e);var n=e.ads.settings.timeout;"number"==typeof e.ads.settings.prerollTimeout&&(n=e.ads.settings.prerollTimeout),this._timeout=e.setTimeout((function(){e.trigger("adtimeout")}),n),t?this.handleAdsReady():this.adsReady=!1},n.onAdsReady=function(e){e.ads.inAdBreak()?a.default.log.warn("Unexpected adsready event (Preroll)"):(e.ads.debug("Received adsready event (Preroll)"),this.handleAdsReady())},n.handleAdsReady=function(){this.adsReady=!0,this.readyForPreroll()},n.afterLoadStart=function(e){var t=this.player;t.ads._hasThereBeenALoadStartDuringPlayerLife?e():(t.ads.debug("Waiting for loadstart..."),t.one("loadstart",(function(){t.ads.debug("Received loadstart event"),e()})))},n.noPreroll=function(){var e=this;this.afterLoadStart((function(){e.player.ads.debug("Skipping prerolls due to nopreroll event (Preroll)"),e.resumeAfterNoPreroll(e.player)}))},n.readyForPreroll=function(){var e=this.player;this.afterLoadStart((function(){e.ads.debug("Triggered readyforpreroll event (Preroll)"),e.trigger("readyforpreroll")}))},n.onAdsCanceled=function(e){var t=this;e.ads.debug("adscanceled (Preroll)"),this.afterLoadStart((function(){t.resumeAfterNoPreroll(e)}))},n.onAdsError=function(e){var t=this;a.default.log("adserror (Preroll)"),this.inAdBreak()?e.ads.endLinearAdMode():this.afterLoadStart((function(){t.resumeAfterNoPreroll(e)}))},n.startLinearAdMode=function(){var e=this.player;!this.adsReady||e.ads.inAdBreak()||this.isContentResuming()?a.default.log.warn("Unexpected startLinearAdMode invocation (Preroll)"):(this.clearTimeout(e),e.ads.adType="preroll",this.waitingForAdBreak=!1,L.start(e),e.ads._shouldBlockPlay=!1)},n.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},n.endLinearAdMode=function(){var e=this.player;this.inAdBreak()&&(e.removeClass("vjs-ad-loading"),e.addClass("vjs-ad-content-resuming"),this.contentResuming=!0,L.end(e))},n.skipLinearAdMode=function(){var e=this,t=this.player;t.ads.inAdBreak()||this.isContentResuming()?a.default.log.warn("Unexpected skipLinearAdMode invocation"):this.afterLoadStart((function(){t.trigger("adskip"),t.ads.debug("skipLinearAdMode (Preroll)"),e.resumeAfterNoPreroll(t)}))},n.onAdTimeout=function(e){var t=this;this.afterLoadStart((function(){e.ads.debug("adtimeout (Preroll)"),t.resumeAfterNoPreroll(e)}))},n.onNoPreroll=function(e){e.ads.inAdBreak()||this.isContentResuming()?a.default.log.warn("Unexpected nopreroll event (Preroll)"):this.noPreroll()},n.resumeAfterNoPreroll=function(e){if(this.contentResuming=!0,e.ads._shouldBlockPlay=!1,this.cleanupPartial(e),e.ads._playRequested||e.ads._pausedOnContentupdate)if(e.paused()){e.ads.debug("resumeAfterNoPreroll: attempting to resume playback (Preroll)");var t=e.play();t&&t.then&&t.then(null,(function(e){}))}else e.ads.debug("resumeAfterNoPreroll: already playing (Preroll)"),e.trigger("play"),e.trigger("playing")},n.cleanup=function(e){e.ads._hasThereBeenALoadStartDuringPlayerLife||a.default.log.warn("Leaving Preroll state before loadstart event can cause issues."),this.cleanupPartial(e)},n.cleanupPartial=function(e){e.removeClass("vjs-ad-loading"),e.removeClass("vjs-ad-content-resuming"),this.clearTimeout(e)},n.clearTimeout=function(e){e.clearTimeout(this._timeout),this._timeout=null},t}(R.getState("AdState"));R.registerState("Preroll",B);var D=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"BeforePreroll"};var a=t.prototype;return a.init=function(e){this.adsReady=!1,this.shouldResumeToContent=!1,e.ads._shouldBlockPlay=!e.ads.settings.allowVjsAutoplay||!e.autoplay()},a.onAdsReady=function(e){e.ads.debug("Received adsready event (BeforePreroll)"),this.adsReady=!0},a.onPlay=function(e){var t=R.getState("Preroll");e.ads.debug("Received play event (BeforePreroll)"),this.transitionTo(t,this.adsReady,this.shouldResumeToContent)},a.onAdsCanceled=function(e){e.ads.debug("adscanceled (BeforePreroll)"),this.shouldResumeToContent=!0},a.onAdsError=function(){this.player.ads.debug("adserror (BeforePreroll)"),this.shouldResumeToContent=!0},a.onNoPreroll=function(){this.player.ads.debug("Skipping prerolls due to nopreroll event (BeforePreroll)"),this.shouldResumeToContent=!0},a.skipLinearAdMode=function(){var e=this.player;e.trigger("adskip"),e.ads.debug("skipLinearAdMode (BeforePreroll)"),this.shouldResumeToContent=!0},a.onContentChanged=function(){this.init(this.player)},t}(R.getState("ContentState"));R.registerState("BeforePreroll",D);var O=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"Midroll"};var a=t.prototype;return a.init=function(e){e.ads.adType="midroll",L.start(e),e.addClass("vjs-ad-loading")},a.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},a.endLinearAdMode=function(){var e=this.player;this.inAdBreak()&&(this.contentResuming=!0,e.addClass("vjs-ad-content-resuming"),e.removeClass("vjs-ad-loading"),L.end(e))},a.onAdsError=function(e){this.inAdBreak()&&e.ads.endLinearAdMode()},a.cleanup=function(e){e.removeClass("vjs-ad-loading"),e.removeClass("vjs-ad-content-resuming")},t}(R.getState("AdState"));R.registerState("Midroll",O);var q=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"Postroll"};var n=t.prototype;return n.init=function(e){if(this.waitingForAdBreak=!0,e.ads._contentEnding=!0,e.ads.nopostroll_){this.resumeContent(e);var t=R.getState("AdsDone");this.transitionTo(t)}else{e.addClass("vjs-ad-loading");var a=e.ads.settings.timeout;"number"==typeof e.ads.settings.postrollTimeout&&(a=e.ads.settings.postrollTimeout),this._postrollTimeout=e.setTimeout((function(){e.trigger("adtimeout")}),a)}},n.startLinearAdMode=function(){var e=this.player;e.ads.inAdBreak()||this.isContentResuming()?a.default.log.warn("Unexpected startLinearAdMode invocation (Postroll)"):(e.ads.adType="postroll",e.clearTimeout(this._postrollTimeout),this.waitingForAdBreak=!1,L.start(e))},n.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},n.endLinearAdMode=function(){var e=this,t=this.player,a=R.getState("AdsDone");this.inAdBreak()&&(t.removeClass("vjs-ad-loading"),this.resumeContent(t),L.end(t,(function(){e.transitionTo(a)})))},n.skipLinearAdMode=function(){var e=this.player;e.ads.inAdBreak()||this.isContentResuming()?a.default.log.warn("Unexpected skipLinearAdMode invocation"):(e.ads.debug("Postroll abort (skipLinearAdMode)"),e.trigger("adskip"),this.abort(e))},n.onAdTimeout=function(e){e.ads.debug("Postroll abort (adtimeout)"),this.abort(e)},n.onAdsError=function(e){e.ads.debug("Postroll abort (adserror)"),e.ads.inAdBreak()?e.ads.endLinearAdMode():this.abort(e)},n.onContentChanged=function(e){if(this.isContentResuming()){var t=R.getState("BeforePreroll");this.transitionTo(t)}else if(!this.inAdBreak()){var a=R.getState("Preroll");this.transitionTo(a)}},n.onNoPostroll=function(e){this.isContentResuming()||this.inAdBreak()?a.default.log.warn("Unexpected nopostroll event (Postroll)"):this.abort(e)},n.resumeContent=function(e){this.contentResuming=!0,e.addClass("vjs-ad-content-resuming")},n.abort=function(e){var t=R.getState("AdsDone");this.resumeContent(e),e.removeClass("vjs-ad-loading"),this.transitionTo(t)},n.cleanup=function(e){e.removeClass("vjs-ad-content-resuming"),e.clearTimeout(this._postrollTimeout),e.ads._contentEnding=!1},t}(R.getState("AdState"));R.registerState("Postroll",q);var N=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"ContentPlayback"};var a=t.prototype;return a.init=function(e){e.ads._shouldBlockPlay=!1},a.onAdsReady=function(e){e.ads.debug("Received adsready event (ContentPlayback)"),e.ads.nopreroll_||(e.ads.debug("Triggered readyforpreroll event (ContentPlayback)"),e.trigger("readyforpreroll"))},a.onReadyForPostroll=function(e){var t=R.getState("Postroll");e.ads.debug("Received readyforpostroll event"),this.transitionTo(t)},a.startLinearAdMode=function(){var e=R.getState("Midroll");this.transitionTo(e)},t}(R.getState("ContentState"));R.registerState("ContentPlayback",N);var U=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"StitchedContentPlayback"};var a=t.prototype;return a.init=function(){this.player.ads._shouldBlockPlay=!1},a.onContentChanged=function(){this.player.ads.debug("Received contentchanged event ("+this.constructor._getName()+")")},a.startLinearAdMode=function(){var e=R.getState("StitchedAdRoll");this.transitionTo(e)},t}(R.getState("ContentState"));R.registerState("StitchedContentPlayback",U);var j=function(e){function t(){return e.apply(this,arguments)||this}s(t,e),t._getName=function(){return"StitchedAdRoll"};var a=t.prototype;return a.init=function(){this.waitingForAdBreak=!1,this.contentResuming=!1,this.player.ads.adType="stitched",L.start(this.player)},a.onPlaying=function(){},a.onContentResumed=function(){},a.onAdEnded=function(){this.endLinearAdMode(),this.player.trigger("ended")},a.endLinearAdMode=function(){var e=R.getState("StitchedContentPlayback");L.end(this.player),this.transitionTo(e)},t}(R.getState("AdState"));R.registerState("StitchedAdRoll",j);var V=_.isMiddlewareMediatorSupported,x=a.default.getTech("Html5").Events,F={timeout:5e3,prerollTimeout:void 0,postrollTimeout:void 0,debug:!1,stitchedAds:!1,contentIsLive:void 0,liveCuePoints:!0,allowVjsAutoplay:a.default.options.normalizeAutoplay||!1},H=function(e){var t=this,i=a.default.obj.merge(F,e),o=[];x.concat(["firstplay","loadedalldata"]).forEach((function(e){-1===o.indexOf(e)&&o.push(e)})),t.on(o,r),V()||function(e,t){t&&a.default.log("Using cancelContentPlay to block content playback"),e.on("play",C)}(t,i.debug),t.setTimeout((function(){t.ads._hasThereBeenALoadStartDuringPlayerLife||""===t.src()||a.default.log.error("videojs-contrib-ads has not seen a loadstart event 5 seconds after being initialized, but a source is present. This indicates that videojs-contrib-ads was initialized too late. It must be initialized immediately after video.js in the same tick. As a result, some ads will not play and some media events will be incorrect. For more information, see http://videojs.github.io/videojs-contrib-ads/integrator/getting-started.html")}),5e3),t.on("ended",(function(){t.hasClass("vjs-has-started")||t.addClass("vjs-has-started")})),t.on("contenttimeupdate",(function(){t.removeClass("vjs-waiting")})),t.on(["addurationchange","adcanplay"],(function(){if(!t.ads.settings.stitchedAds&&!t.hasStarted()&&(!t.ads.snapshot||t.currentSrc()!==t.ads.snapshot.currentSrc)&&t.ads.inAdBreak()){var e=t.play();e&&e.catch&&e.catch((function(e){a.default.log.warn("Play promise rejected when playing ad",e)}))}})),t.on("nopreroll",(function(){t.ads.debug("Received nopreroll event"),t.ads.nopreroll_=!0})),t.on("nopostroll",(function(){t.ads.debug("Received nopostroll event"),t.ads.nopostroll_=!0})),t.on("playing",(function(){t.ads._cancelledPlay=!1,t.ads._pausedOnContentupdate=!1})),t.on("play",(function(){t.ads._playRequested=!0})),t.one("loadstart",(function(){t.ads._hasThereBeenALoadStartDuringPlayerLife=!0})),t.on("loadeddata",(function(){t.ads._hasThereBeenALoadedData=!0})),t.on("loadedmetadata",(function(){t.ads._hasThereBeenALoadedMetaData=!0})),t.ads=function(e){return{disableNextSnapshotRestore:!1,_contentEnding:!1,_contentHasEnded:!1,_hasThereBeenALoadStartDuringPlayerLife:!1,_hasThereBeenALoadedData:!1,_hasThereBeenALoadedMetaData:!1,_inLinearAdMode:!1,_shouldBlockPlay:!1,_playBlocked:!1,_playRequested:!1,adType:null,VERSION:n,reset:function(){e.ads.disableNextSnapshotRestore=!1,e.ads._contentEnding=!1,e.ads._contentHasEnded=!1,e.ads.snapshot=null,e.ads.adType=null,e.ads._hasThereBeenALoadedData=!1,e.ads._hasThereBeenALoadedMetaData=!1,e.ads._cancelledPlay=!1,e.ads._shouldBlockPlay=!1,e.ads._playBlocked=!1,e.ads.nopreroll_=!1,e.ads.nopostroll_=!1,e.ads._playRequested=!1},startLinearAdMode:function(){e.ads._state.startLinearAdMode()},endLinearAdMode:function(){e.ads._state.endLinearAdMode()},skipLinearAdMode:function(){e.ads._state.skipLinearAdMode()},stitchedAds:function(e){return void 0!==e&&(a.default.log.warn("Using player.ads.stitchedAds() as a setter is deprecated, it should be set as an option upon initialization of contrib-ads."),this.settings.stitchedAds=!!e),this.settings.stitchedAds},videoElementRecycled:function(){if(e.ads.shouldPlayContentBehindAd(e))return!1;if(!this.snapshot)throw new Error("You cannot use videoElementRecycled while there is no snapshot.");var t=e.tech_.src()!==this.snapshot.src,a=e.currentSrc()!==this.snapshot.currentSrc;return t||a},isLive:function(t){return void 0===t&&(t=e),"boolean"==typeof t.ads.settings.contentIsLive?t.ads.settings.contentIsLive:t.duration()===1/0||"8"===a.default.browser.IOS_VERSION&&0===t.duration()},shouldPlayContentBehindAd:function(t){if(void 0===t&&(t=e),t)return!!t.ads.settings.liveCuePoints&&!a.default.browser.IS_IOS&&!a.default.browser.IS_ANDROID&&t.duration()===1/0;throw new Error("shouldPlayContentBehindAd requires a player as a param")},shouldTakeSnapshots:function(t){return void 0===t&&(t=e),!this.shouldPlayContentBehindAd(t)&&!this.stitchedAds()},isInAdMode:function(){return this._state.isAdState()},isWaitingForAdBreak:function(){return this._state.isWaitingForAdBreak()},isContentResuming:function(){return this._state.isContentResuming()},isAdPlaying:function(){return this._state.inAdBreak()},inAdBreak:function(){return this._state.inAdBreak()},removeNativePoster:function(){var t=e.$(".vjs-tech");t&&t.removeAttribute("poster")},debug:function(){if(this.settings.debug){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];1===t.length&&"string"==typeof t[0]?a.default.log("ADS: "+t[0]):a.default.log.apply(a.default,["ADS:"].concat(t))}}}}(t),t.ads.settings=i,i.stitchedAds=!!i.stitchedAds,i.stitchedAds?t.ads._state=new(R.getState("StitchedContentPlayback"))(t):t.ads._state=new(R.getState("BeforePreroll"))(t),t.ads._state.init(t),t.ads.cueTextTracks=v,t.ads.adMacroReplacement=y.bind(t),function(e){e.ads.contentSrc=e.currentSrc(),e.ads._seenInitialLoadstart=!1,e.on("loadstart",(function(){if(!e.ads.inAdBreak()){var t=e.currentSrc();t!==e.ads.contentSrc&&(e.ads._seenInitialLoadstart&&e.trigger({type:"contentchanged"}),e.trigger({type:"contentupdate",oldValue:e.ads.contentSrc,newValue:t}),e.ads.contentSrc=t),e.ads._seenInitialLoadstart=!0}}))}(t),t.on("contentchanged",t.ads.reset);var d=function(){var e=t.textTracks();if(!t.ads.shouldPlayContentBehindAd(t)&&t.ads.inAdBreak()&&t.tech_.featuresNativeTextTracks&&a.default.browser.IS_IOS&&!Array.isArray(t.textTracks()))for(var n=0;n<e.length;n++){var i=e[n];"showing"===i.mode&&(i.mode="disabled")}};t.ready((function(){t.textTracks().addEventListener("change",d)})),t.on(["play","playing","ended","adsready","adscanceled","adskip","adserror","adtimeout","adended","ads-ad-started","ads-ad-skipped","contentchanged","dispose","contentresumed","readyforpostroll","nopreroll","nopostroll"],(function(e){t.ads._state.handleEvent(e.type)})),t.on("dispose",(function(){t.ads.reset(),t.textTracks().removeEventListener("change",d)})),c(),m((function(){})),t.ads.listenToTcf=c,t.ads.updateUsPrivacyString=function(e){return m(e)}};H.VERSION=n,function(e){!function(){if(a.default.getPlugin)return Boolean(a.default.getPlugin("ads"));var e=a.default.getComponent("Player");return Boolean(e&&e.prototype.ads)}()&&((a.default.registerPlugin||a.default.plugin)("ads",e),P()&&!a.default.usingContribAdsMiddleware_&&(a.default.use("*",b),a.default.usingContribAdsMiddleware_=!0,a.default.log.debug("Play middleware has been registered with videojs")))}(H);let W;(a.default.registerPlugin||a.default.plugin)("contribAds6Shim",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,n=void 0,i=void 0,o=0,r=!1;this.contribAds6Shim={VERSION:"1.0.1"},t.ads.state=n=i="content-set",Object.defineProperty(t.ads,"state",{get:function(){return(!0===e.warnOnGetState||"number"==typeof e.warnOnGetState&&o<e.warnOnGetState)&&(a.default.log.warn("player.ads.state is deprecated. Please use the public methods provided by videojs-contrib-ads 6 instead: https://github.com/videojs/videojs-contrib-ads#public-methods"),o++),e.stateUsageEvent&&!r&&(t.trigger({type:"usage",name:"contrib-ads-state-access"}),r=!0),i},set:function(t){t!==i&&(n=i,i=t,e.debug&&a.default.log("CA6Shim: "+n+" -> "+i))}}),t.on("contentchanged",(function(){t.paused()?t.ads.state="content-set":t.ads.state="ads-ready?"})),t.on("play",(function(){"content-set"===i?t.ads.state="ads-ready?":"ads-ready"===i&&(t.ads.state="preroll?")})),t.on("adsready",(function(){"content-set"===i?t.ads.state="ads-ready":"ads-ready?"===i&&(t.ads.state="preroll?")})),t.on(["adserror","adtimeout","adskip"],(function(){"ads-ready?"!==i&&"preroll?"!==i||(t.ads.state="content-playback")})),t.on("adstart",(function(){t.ads.state="ad-playback"})),t.on("adend",(function(){t.ads.state="content-resuming"})),t.on("playing",(function(){"content-playback"!==i&&(t.trigger("contentplayback"),e.debug&&a.default.log("CA6Shim: Triggered contentplayback")),t.ads.state="content-playback"})),t.on("contentended",(function(){"content-playback"===i&&(t.ads.state="postroll?")})),t.on("ended",(function(){t.ads.state="content-playback"}))}));const z=function(e,t){const a=t.cues,n=t.label,i=t.inBandMetadataTrackDispatchType,o=t.kind;if("metadata"===o)return"media-cues"===n||(!(!i||"metadata"!==o)||(!a||!a.length||e.ima3.cueState_.cueModule.isSupportedAdCue(e,a[0])))},$=function(e,t,a,n,i){0===n&&e.ima3.cueState_.prerollPlayed||i<=1&&e.ima3.cueState_.postrollPlayed||(!function(e,t,a){const n=Math.abs(a-e.duration()),i=Math.abs(a-e.currentTime());let o;if(0===a){if(e.ima3.cueState_.prerollPlayed)return;e.ima3.cueState_.prerollPlayed=!0,e.ads.adType="preroll"}if(n<=1){if(e.ima3.cueState_.postrollPlayed)return;e.ima3.cueState_.postrollPlayed=!0}i>=1||(o=!e.ima3.settings.useMediaCuePoints&&t.serverUrl?t.serverUrl:e.ima3.settings.serverUrl,o=e.ima3.adMacroReplacement(o),t.duration&&(/\?/.test(o)?o+="&breaklength="+t.duration:o+="?breaklength="+t.duration),e.ima3.isReady_&&(e.ima3.log(`Oncue ad request at ${a} seconds`),e.ima3.adrequest(o)))}(e,t,n),e.ima3.cueState_.usedActiveCues[a]=!0)},Q=function(e,t,a,n,i){0===n&&0===e.currentTime()&&(e.ima3.cueState_.prerollPlayed||e.ima3.cueState_.prerollHandledEarly||(e.paused()&&!e.ads._playRequested?(e.ima3.cueState_.prerollHandledEarly=!0,e.ima3.oneUnlessContentUpdate_("play",(()=>{$(e,t,a,n,i)}))):e.ads.isInAdMode()&&!e.ads.isContentResuming()&&e.ads._playRequested&&$(e,t,a,n,i)))},G=function(e){return e.mediainfo?Math.max(e.duration(),e.mediainfo.duration):e.duration()},Y=function(e,t,a,n){const i=G(e),o=Math.abs(n-i);var r;e.ads.isAdPlaying()&&((r=t)&&r.text&&"ad"===r.text.toLowerCase()||r&&r.name&&"adcue"===r.name.toLowerCase())||(a?e.ima3.cueState_.usedActiveCues[a]||t.name&&"adcancel"===t.name.toLowerCase()||(0===n?Q(e,t,a,n,o):o<=1&&!e.ima3.cueState_.postrollHandled?(e.ima3.cueState_.postrollHandled=!0,e.ima3.oneUnlessContentUpdate_("contentended",(()=>{$(e,t,a,n,o)}))):e.ima3.isReady_&&!e.ads.isInAdMode()&&$(e,t,a,n,o)):e.ima3.log.error("The cue does not have an ID and cannot be used",t))},J=function(e,t,a,n){e.ima3.settings.useMediaCuePoints||"adCancel"!==t.name||!e.ima3.adsManager||e.ima3.cueState_.usedActiveCues[a]||(e.ima3.cueState_.usedActiveCues[a]=!0,e.ima3.adsManager.stop(),e.ima3.log("Cancelling oncue ad at "+n+" seconds"))},K=function(e){return function(){const t=this.activeCues;if(!e.scrubbing()&&t&&t.length){const a=[t[t.length-1]];if(!z(e,this))return void this.removeEventListener("cuechange",e.ima3.cueState_.adCueChangeHandler);e.ima3.cueState_.cueModule.processAdTrack(e,a,Y,J)}}},X=function(e,t){const a=t.cues;let n,i;if(z(e,t)){if(a&&void 0!==a.length){for(let t=0;t<a.length;t++){const o=e.mediainfo?Math.max(e.duration(),e.mediainfo.duration):e.duration();Math.abs(a[t].startTime-o)<=1?n=a[t]:0===a[t].startTime&&(i=a[t])}if(i||"media-cues"!==t.label){if(i){const t=e.ima3.cueState_.cueModule.getSupportedAdCue(e,i),a=e.ima3.cueState_.cueModule.getCueId(e,i),n=i.startTime,o=Math.abs(n-G(e));Q(e,t,a,n,o)}}else e.trigger("nopreroll");n||"media-cues"!==t.label||e.trigger("nopostroll")}t.addEventListener("cuechange",e.ima3.cueState_.adCueChangeHandler)}};W={init:(e,t)=>{t.useMediaCuePoints||e.on("loadedmetadata",(()=>{e.trigger("nopreroll"),W.liveCuePointHandler(e,e.ads.cueTextTracks)})),e.trigger("adsready"),e.on("contentchanged",(()=>{e.trigger("adsready")}))},liveCuePointHandler:(e,t)=>{!function(e,t){e.ima3.cueState_={cueModule:t,adCueChangeHandler:K(e),usedActiveCues:{},prerollHandledEarly:!1,prerollPlayed:!1,postrollHandled:!1,postrollPlayed:!1}}(e,t),e.ima3.cueState_.cueModule.setMetadataTrackMode=function(e){e.mode="hidden"},e.ima3.cueState_.cueModule.getCueId=function(e,t){const a=e.ima3.cueState_.cueModule.getSupportedAdCue(e,t);return a?a.id:null},e.ima3.cueState_.cueModule.isSupportedAdCue=function(e,t){return null!==e.ima3.cueState_.cueModule.getSupportedAdCue(e,t)},e.ima3.cueState_.cueModule.getSupportedAdCue=function(e,t){return"oncue"!==e.ima3.settings.requestMode||e.ima3.settings.useMediaCuePoints?null:function(e){let t;if(e&&!e.value||"TXXX"!==e.value.key)return null;try{t=JSON.parse(e.value.data)}catch(e){return a.default.log.error("ERROR: Parsing JSON. Please confirm that JSON is valid.",e.message),null}if(!t.name)return null;const n=t.name.toLowerCase();return"adcue"!==n&&"adcancel"!==n?null:t}(t)},e.ima3.cueState_.cueModule.processMetadataTracks(e,X)}};var Z=W;function ee(e){let t=!1,n=!1,i=null,o=null;const r=()=>{e.tech(!0).trigger("durationchange"),e.trigger("timeupdate"),e.trigger("progress")};e.on("ima3-started",(function(){e.removeClass("vjs-ima3-paused"),e.trigger("play"),t=!1,e.ads.inAdBreak()&&!e.ads.videoElementRecycled()&&(i=e.volume(),o=e.muted())})),e.on("ads-ad-started",(function(){n=!0,"boolean"==typeof o&&o?e.muted(o):"number"==typeof i&&e.volume(i),r()})),e.on("ima3-resumed",(function(){e.removeClass("vjs-ima3-paused"),e.trigger("play"),t=!1})),e.on("ima3-paused",(function(){e.addClass("vjs-ima3-paused"),e.trigger("pause"),t=!0})),e.on(["ima3-complete","ima3-content-resume-requested"],(function(){n=!1,r()}));const d=t=>a=>e.usingPlugin("ima3")&&e.ads.isAdPlaying()&&e.ima3.adsManager&&n?t(a):a;return{currentTime:d((function(){const t=e.duration();if("number"!=typeof t||!e.ima3.adsManager)return 0;const a=e.ima3.adsManager.getRemainingTime();return"number"!=typeof a||a<=0||a>t?0:t-a})),duration:d((function(){const t=e.ima3.currentAd;if(!t)return 0;const a=t.getDuration();return a>0?a:0})),buffered:d((function(t){const n=[],i=e.duration();for(let e=0;e<t.length;e++){const a=t.start(e),o=t.end(e);a>i||(o>i?n.push([a,i]):n.push([a,o]))}return a.default.createTimeRanges(n)})),callPause:d((function(){return t=!0,e.ima3.adsManager.pause(),e.trigger("pause"),a.default.middleware.TERMINATOR})),paused:d((function(){return t})),callPlay:d((function(){return t=!1,e.ima3.adsManager.resume(),e.trigger("play"),a.default.middleware.TERMINATOR})),setVolume:d((function(t){return e.ima3.adsManager.setVolume(t),e.ima3.volume=t,e.trigger("volumechange"),t})),volume:d((function(){return e.ima3.adsManager.getVolume()||e.ima3.volume})),setMuted:d((function(t){return e.ima3.adsManager.setVolume(t?0:e.ima3.volume||1),t})),muted:d((function(){return 0===e.ima3.adsManager.getVolume()})),ended:d((function(){return!1}))}}function te(e){if("string"!=typeof e)return;const t=e.match(/^([\d]+)\.([\d]+)\.([\d]+)/);return t?[Number(t[1]),Number(t[2]),Number(t[3])]:void 0}const ae=te("7.3.5");function ne(e){return a.default.getPlugin?a.default.getPlugin(e):a.default.getComponent("Player").prototype[e]}let ie;function oe(e){return{width:parseInt(ie.computedStyle(e.el(),"width"),10),height:parseInt(ie.computedStyle(e.el(),"height"),10)}}function re(e){if(+e<0)return a.default.log.error("duration "+e+" can't be a negative number"),"00:00:00.000";if(+e>=86400)return a.default.log.error("duration "+e+" can't be over 24h"),"00:00:00.000";const t=1e3*e;let n=parseInt(t%1e3,10),i=parseInt(t/1e3%60,10),o=parseInt(t/6e4%60,10),r=parseInt(t/36e5%24,10);return r=r<10?"0"+r:r,o=o<10?"0"+o:o,i=i<10?"0"+i:i,n<10?n="00"+n:n<100&&(n="0"+n),r+":"+o+":"+i+"."+n}function de(e){e.ima3.adsManager&&(e.ima3.log("[util.destroyAdsManager] Call AdsManager.destroy."),e.ima3.adsManager.destroy(),e.ima3.adsManager=null),e.ima3.managerCleanup&&(e.ima3.managerCleanup(),e.ima3.managerCleanup=null)}function se(e){for(let t=1;t<arguments.length;t++){const a=arguments[t];for(const t in a)a.hasOwnProperty(t)&&(e[t]=a[t])}return e}const le=e=>{if(void 0!==e)return"application/javascript"===e.getContentType();throw new Error("Cannot check if the current ad is a VPAID when there is no ad.")},ue=e=>!(!e||0!==e.getCuePoints().length),ce=e=>e&&"object"==typeof e&&"function"==typeof e.trigger;function ge(e,t){e&&e.bcAnalytics&&e.bcAnalytics.insightsBeacons&&"function"==typeof e.bcAnalytics.insightsBeacons[t]&&e.bcAnalytics.insightsBeacons[t]()}const me=e=>{let t=!1;try{t=new URL(e)}catch(e){}return t};ie={assignIfTruthy:(e,t,a)=>{a&&(e[t]=a)},computedStyle:function(e,t){return"function"==typeof getComputedStyle?window.getComputedStyle(e)[t]:e.currentStyle[t]},destroyAdsManager:de,extend:se,getPlayerDimensions:oe,includesPostroll:e=>e.getCuePoints().indexOf(-1)>=0,includesPreroll:e=>ue(e)||e.getCuePoints().indexOf(0)>=0,isEconomicsFree:e=>"object"==typeof e.mediainfo&&"FREE"===e.mediainfo.economics,isLive:e=>{const{mediainfo:t,liveTracker:a}=e,n=t&&t.duration||e.duration&&e.duration()||null;return a&&a.isLive()||n===1/0},isValidUrl:me,isVast:ue,isVmap:e=>!(!e||0===e.getCuePoints().length),isVpaid:le,loadScript:function(e,t){let a=document.createElement("script");const n=document.querySelector("head");a.async=!0,a.charset="utf-8",a.src=e,a.onload=()=>t(null),a.onerror=e=>{t(e),a.parentNode.removeChild(a),a=null},n.insertBefore(a,n.firstChild)},secondsToTime:re,sendInsightsBeacon:ge,usingAutoAdvance:ce,usingMediaCuepoints:e=>"oncue"===e.requestMode&&e.useMediaCuePoints,usingLiveAdCuepoints:e=>"oncue"===e.requestMode&&!e.useMediaCuePoints};var pe=ie;let fe;fe={_addPlayerDimensions:(e,t)=>{(0,a.default.ima3.extend)(t,{linearAdSlotWidth:e.width,linearAdSlotHeight:e.height,nonLinearAdSlotWidth:e.width,nonLinearAdSlotHeight:e.height})},_addVmap:(e,t,a)=>{e.ima3.isReady_?t.adsResponse=a:e.ima3.oneUnlessContentUpdate_("ima3-ready",(()=>{t.adsResponse=a}))},_adsRequest:(e,t,a)=>{const n=e.ima3.settings.requestMode,i=e.ima3.settings.useMediaCuePoints,o=window.google.ima;if(!o||o&&!o.AdsRequest)throw new Error("An ad request was made before the plugin is ready");e.ima3.log("[adsRequest] Create ima.AdsRequest.");const r=new o.AdsRequest;fe._addPlayerDimensions(pe.getPlayerDimensions(e),r),"oncue"===n&&i&&a?fe._addVmap(e,r,a):r.adTagUrl=t,e.ima3.adsRequest=r;const d=t=>{const a=!(!t||"autoplay-success"!==t.type);r.setAdWillAutoPlay(a),r.setAdWillPlayMuted(e.muted()),(t=>{const a=e.ima3.settings.omidAccessModeRules||{};t.omidAccessModeRules=e.ima3.adsRequest.omidAccessModeRules||{};for(const e in a){const n=a[e],i=o.OmidVerificationVendor[e];i&&(t.omidAccessModeRules[o.OmidVerificationVendor[i]]=o.OmidAccessMode[n])}t.omidAccessModeRules.OTHER||(t.omidAccessModeRules.OTHER="LIMITED")})(r),e.trigger({type:"ads-before-request",adsRequest:r}),e.ima3.adsLoader.requestAds(r),e.trigger("ads-request")};if(e.ima3._contentchangedSeen){d({type:e.autoplay()?"autoplay-success":"autoplay-failure"})}else!1===e.autoplay()?d():e.ima3._autoplayResultEvent?d(e.ima3._autoplayResultEvent):e.any(["autoplay-success","autoplay-failure"],d)},_handleEconomicsFree:e=>{e.trigger("nopreroll"),e.trigger("nopostroll")},_isRepeatForSourceAllowed:e=>{const t=e.ima3.settings.requestMode;return"onload"!==t&&"onplay"!==t},_isRepeatForSource:e=>e.ima3.lastSrc_===e.currentSrc(),_handleMissingAdTagUrl:e=>{e.trigger("adscanceled"),e.trigger("nopreroll"),e.trigger("nopostroll")},_afterServerUrlFunctionCheck:(e,t,a)=>{e.ads.updateUsPrivacyString((()=>{(()=>{const n=e.ima3.settings.requestMode;let i;null!=t&&(i=e.ima3.adMacroReplacement(t)),"oncue"===n||i?fe._adsRequest(e,i,a):fe._handleMissingAdTagUrl(e)})()}))},_handleServerUrlFunctionResponse:(e,t)=>{pe.isEconomicsFree(e)?fe._handleEconomicsFree(e):fe._afterServerUrlFunctionCheck(e,t)},_afterPlay:(e,t,a)=>{const n=e.ima3.settings.useMediaCuePoints;pe.isEconomicsFree(e)?fe._handleEconomicsFree(e):(n||(t=t||e.ima3.settings.serverUrl),n||"function"!=typeof t?fe._afterServerUrlFunctionCheck(e,t,a):t((t=>{fe._handleServerUrlFunctionResponse(e,t)})))},_shouldWaitUntilPlay:e=>{const t=e.ima3.settings.requestMode,a=e.ima3.settings.useMediaCuePoints;return("onplay"===t||"oncue"===t&&a)&&!e.ima3._playSeen&&e.paused()&&!e.ads._pausedOnContentupdate},_waitUntilPlay:(e,t,a)=>{pe.isEconomicsFree(e)?fe._handleEconomicsFree(e):(e.ima3._requestAdsOnPlay=()=>{fe._afterPlay(e,t,a)},e.one("play",e.ima3._requestAdsOnPlay))},requestAds:(e,t,a)=>{e.ima3.log("[requestAds] Beginning ad request process."),!fe._isRepeatForSource(e)||fe._isRepeatForSourceAllowed(e)?fe._shouldWaitUntilPlay(e)?fe._waitUntilPlay(e,t,a):fe._afterPlay(e,t,a):e.ima3.log("Cancelling repeat adsRequest for "+e.currentSrc())}};var he=fe;const ye=e=>{e.trigger("nopreroll"),e.trigger("nopostroll")},ve=(e,t)=>{t.ima3.isReady_?"AdsDone"!==t.ads._state.constructor._getName()?t.mediainfo&&"FREE"===t.mediainfo.economics?t.ima3.log("On demand adRequest attempted on video with advertising disabled."):e?(t.ima3.log("Clearing any previous VAST ad data and triggering ondemand adrequest."),t.ads.startLinearAdMode(),de(t),he.requestAds(t,e),t.addClass("ima3-ad-loading")):t.ima3.log("On demand adRequest attempted without an adTagUrl."):t.ima3.log("On demand adRequest cannot occur when player.ads is in AdsDone state."):t.ima3.log.error("Cannot make an ad request when the plugin is not ready. Skipping ad...")};class Ae{constructor(e){this.player=e,this.audibleState=this.playerAudibleState(e),this.audibleTracking={totalAudibleSec:0,start:0}}isAudible(e){return e.volume>=.01&&!e.muted}playerAudibleState(e){return{volume:e.volume(),muted:e.muted()}}audibleStateChanged(e,t){return this.isAudible(e)&&!this.isAudible(t)?1:!this.isAudible(e)&&this.isAudible(t)?2:0}handleVolumeChange(){const e=this.audibleStateChanged(this.audibleState,this.playerAudibleState(this.player));1===e&&(this.audibleTracking.totalAudibleSec+=this.player.ads.ad.currentTime-this.audibleTracking.start),2===e&&(this.audibleTracking.start=this.player.ads.ad.currentTime),this.audibleState=this.playerAudibleState(this.player)}handleAdComplete(){this.isAudible(this.playerAudibleState(this.player))&&(this.audibleTracking.totalAudibleSec+=this.player.ads.ad.currentTime-this.audibleTracking.start),this.player.ads.ad.audible_duration=this.audibleTracking.totalAudibleSec}}const Se={0:"PREROLL","-1":"POSTROLL"},Ce=(e,t,a)=>{""!==a&&(e.currentAdEventInfo[t]?e.currentAdEventInfo[t].push(a):e.currentAdEventInfo[t]=[a])};const _e=(e,t)=>{void 0!==e.ima3.currentAd&&(e.ads.ad.id=e.ima3.currentAd.getAdId(),e.ads.ad.duration=e.ima3.currentAd.getDuration(),e.ads.ad.currentTime=e.ima3.adsManager?e.ima3.currentAd.getDuration()-e.ima3.adsManager.getRemainingTime():e.ima3.currentAd.getDuration(),e.ads.ad.timeOffset=e.ima3.currentAd.getAdPodInfo().getTimeOffset(),e.ads.ad.index=e.ima3.currentAd.getAdPodInfo().getAdPosition()-1,e.ads.ad.type=Se[e.ima3.currentAd.getAdPodInfo().getTimeOffset()]||"MIDROLL",e.ads.pod.id=e.ima3.currentAd.getAdPodInfo().getPodIndex(),e.ads.pod.size=e.ima3.currentAd.getAdPodInfo().getTotalAds(),"ima3-started"===t&&(((e,t)=>{if(void 0===t)return;const a=e.ima3;a.currentAdEventInfo.adPodId=e.ads.pod.id,a.currentAdEventInfo.adPodLength=e.ads.pod.size,a.currentAdEventInfo.adType=e.ads.adType,Ce(a,"adId",e.ads.ad.id),Ce(a,"creativeLength",e.ads.ad.duration),Ce(a,"creativeIndex",e.ads.ad.index),Ce(a,"creativeId",t.getCreativeId()),Ce(a,"creativeAdId",t.getCreativeAdId()),Ce(a,"creativeFormat",t.getContentType()),Ce(a,"creativeUrl",t.getMediaUrl()),Ce(a,"surveyUrl",t.getSurveyUrl()),Ce(a,"adTitle",t.getTitle()),Ce(a,"wrapperCreativeIds",t.getWrapperCreativeIds()),Ce(a,"advertiserName",t.getAdvertiserName()),Ce(a,"dealId",t.getDealId()),Ce(a,"adSystem",t.getAdSystem()),Ce(a,"wrapperAdSystems",t.getWrapperAdSystems())})(e,e.ima3.currentAd),Ce(e.ima3,"started",e.ads.ad.index)),function(e,t){const a={0:"pre","-1":"post"},n=e.ima3.currentAd,{ad:i,pod:o}=e.ads,r=n.getAdPodInfo().getTimeOffset(),d=n.getWrapperAdSystems(),s=e.ima3.currentAd.getSkipTimeOffset(),l=e.ima3.adsManager?e.ima3.adsManager.getRemainingTime():0,u=e.ima3.currentAd.getDuration(),c=u-l;if("ima3-started"===t&&(pe.isLive(e)||(e.ads.pod.index=e.ima3.currentAd.getAdPodInfo().getPodIndex()),"function"==typeof e.on)){const t=new Ae(e);e.on("advolumechange",t.handleVolumeChange.bind(t)),e.one(["ima3-complete","ima3-skip"],(a=>{e.off("advolumechange",t.handleVolumeChange),t.handleAdComplete.bind(t)()}))}pe.assignIfTruthy(i,"deal_id",n.getDealId()),pe.assignIfTruthy(i,"wrapper_systems",Array.isArray(d)&&d.join(",")),pe.assignIfTruthy(i,"system",n.getAdSystem()),pe.assignIfTruthy(i,"advertiser",n.getAdvertiserName()),pe.assignIfTruthy(i,"content_type",n.getContentType()),pe.assignIfTruthy(i,"isci",n.getCreativeAdId()),pe.assignIfTruthy(i,"creative_id",n.getCreativeId()),pe.assignIfTruthy(i,"title",n.getTitle());try{const{host:e}=new URL(n.getMediaUrl());pe.assignIfTruthy(i,"media_url_domain",e)}catch(t){e.ima3.log.error(t)}if(i.currentTime=c,"number"==typeof u&&u>=0&&l<=u?i.play_duration="number"==typeof l&&l>=0?u-l:u:"number"==typeof u&&u>=0&&l>u&&(i.play_duration=0),-1!==s&&(i.skip_time_offset=s),o.ad_count=n.getAdPodInfo().getTotalAds(),"number"==typeof r&&(o.type=a[r]||"mid"),o.time_offset=-1!==r?r:e.duration(),"number"==typeof n.getAdPodInfo().getPodIndex()){if(void 0===o.durationTracker)o.durationTracker={podIndex:n.getAdPodInfo().getPodIndex(),adIndex:e.ima3.currentAd.getAdPodInfo().getAdPosition(),total:e.ima3.currentAd.getDuration()};else{const e=o.durationTracker.podIndex,t=o.durationTracker.adIndex;n.getAdPodInfo().getPodIndex()!==e?(o.durationTracker.podIndex=n.getAdPodInfo().getPodIndex(),o.durationTracker.adIndex=n.getAdPodInfo().getAdPosition(),o.durationTracker.total=n.getDuration()):n.getAdPodInfo().getAdPosition()!==t&&(o.durationTracker.adIndex=n.getAdPodInfo().getAdPosition(),o.durationTracker.total=o.durationTracker.total+n.getDuration())}pe.assignIfTruthy(o,"duration",o.durationTracker&&o.durationTracker.total)}}(e,t)),"ima3-complete"===t&&Ce(e.ima3,"completed",e.ads.ad.index)};function Me(){const e=me(document.referrer),t=me(window.location.href);return a.default.dom.isInFrame()&&e?e:t||{}}function be(e){return`${e.origin||""}${e.pathname||""}`}const Pe=(e,t="",a)=>{const n=be(Me()),i=(e=>{try{const t=new URL(e);return t.hostname.includes("tv.springserve.com")||t.hostname.includes("vid.springserve.com")}catch(e){return!1}})(t),o=i?(e=>{const t=Me(),a=be(t);return{macroNameOverrides:{"{player.width}":"{{WIDTH}}","{player.height}":"{{HEIGHT}}","{player.autoplay}":"{{AUTOPLAY}}","{player.muted}":"{{MUTE}}","{player.language}":"{{LANGUAGE}}","{mediainfo.duration}":"{{DURATION}}","{mediainfo.description}":"{{DESCRIPTION}}","{mediainfo.id}":"r:(\\{\\{)(MEDIA|VIDEO|CONTENT)(_ID)(\\}\\})","{mediainfo.name}":"r:(\\{\\{(ENCODED_VIDEO|CONTENT)_TITLE\\}\\})","{tcf.tcString}":"{{CONSENT}}","{tcf.gdprApplies}":"{{GDPR}}","{random}":"{{CACHEBUSTER}}","{usp.uspString}":"{{US_PRIVACY}}"},"{{DOMAIN}}":t.hostname,"{{ENCODED_URL}}":a,"{{DOUBLE_ENCODED_URL}}":encodeURIComponent(a),"{{CONTENT_LIVESTREAM}}":e.mediainfo&&-1===e.mediainfo.duration?1:0,"{{KEYWORDS}}":Array.isArray(e.mediainfo&&e.mediainfo.tags)?e.mediainfo.tags.join(","):""}})(e):{};if(e.bcinfo&&(o["{player.url}"]=e.bcinfo.scriptUrl,o["{player.accountId}"]=e.bcinfo.accountId),i&&t.includes("{{URL}}")&&(t=t.replace("{{URL}}",n)),a&&a.metadata&&-1!==t.indexOf("{mediainfo.ad_keys}")){const e=encodeURIComponent(a.metadata);t=t.replace("{mediainfo.ad_keys}",e)}return e.ads.adMacroReplacement(t,!0,o)};var Re="5.2.8";const ke=(e,t)=>{const a=e.el().querySelector(".vjs-tech"),n=e.log.createLogger("IMA3"),i={readyQueue_:[],isReady_:!1,player:e,tech:a,settings:t,ready:t=>(t&&(e.ima3.isReady_?t.call(e):(void 0===e.ima3.readyQueue_&&(e.ima3.readyQueue_=[]),e.ima3.readyQueue_.push(t))),e.ima3),adMacroReplacement:t=>Pe(e,t),insertAdContainer:t=>{((e,t)=>{const a=e.el().querySelector(".vjs-big-play-button");e.el().insertBefore(t,a)})(e,t)},currentAdEventInfo:{},addToCurrentAdEventInfo:(t,a)=>{Ce(e,t,a)},setAdsRenderingSettings(t){((e,t)=>{if(e.ima3.adsRenderingSettings_=t,e.ima3.adsManager){let a;const n=window.google.ima;t instanceof n.AdsRenderingSettings?a=t:(a=new n.AdsRenderingSettings,Object.keys(t).forEach((e=>{a[e]=t[e]}))),e.ima3.adsManager.updateAdsRenderingSettings(a)}})(e,t)},log:n,toggleLogger(e){e?(n.level("debug"),n.history.enable()):(n.level("warn"),n.history.disable())},oneHandlers_:[],oneUnlessContentUpdate_(t,a){((e,t,a)=>{e.ima3.oneHandlers_.push({type:t,handler:a}),e.one(t,a)})(e,t,a)},isVpaid:()=>le(e.ima3.currentAd),version:Re,VERSION:Re};return e.on("contentupdate",(function(){const t=e.ima3.oneHandlers_;for(let a=0;a<t.length;a++){const n=t[a];e.off(n.type,n.handler)}e.ima3.oneHandlers_=[]})),e.on("ima3-ready",(function(){e.ima3.isReady_=!0;for(let t=0;t<e.ima3.readyQueue_.length;t++)e.ima3.readyQueue_[t].call(e);e.ima3.readyQueue_=[]})),i.toggleLogger(t.debug),e.on("debugon",(()=>e.ima3.toggleLogger(!0))),e.on("debugoff",(()=>e.ima3.toggleLogger(!1))),i};function Te(e){const t=e.mediainfo,a=e.ima3.settings.serverUrl;if(t&&"AD_SUPPORTED"===t.economics&&t.cuePoints.length>0&&t.cuePoints.some((e=>"AD"===e.type))){let n='<vmap:VMAP xmlns:vmap="http://www.iab.net/videosuite/vmap" version="1.0">\n';for(let i=0;i<t.cuePoints.length;i++)if("AD"===t.cuePoints[i].type){t.cuePoints[i].time<1?n+='<vmap:AdBreak timeOffset="start" breakType="linear" breakId="'+t.cuePoints[i].name+'">\n':t.duration-t.cuePoints[i].time<1?n+='<vmap:AdBreak timeOffset="end" breakType="linear" breakId="'+t.cuePoints[i].name+'">\n':n+='<vmap:AdBreak timeOffset="'+re(t.cuePoints[i].time)+'" breakType="linear" breakId="'+t.cuePoints[i].name+'">\n';const o=Pe(e,a,t.cuePoints[i]);n+=' <vmap:AdSource id="'+t.cuePoints[i].id+'" allowMultipleAds="true" followRedirects="true">\n<vmap:AdTagURI templateType="vast3">\n<![CDATA['+o+"]]>\n</vmap:AdTagURI>\n</vmap:AdSource>\n</vmap:AdBreak>\n"}return n+="</vmap:VMAP>",n}return null}const we={"ima3-click":"ads-click","ima3-started":"ads-ad-started","ima3-complete":"ads-ad-ended","ima3-first-quartile":"ads-first-quartile","ima3-midpoint":"ads-midpoint","ima3-third-quartile":"ads-third-quartile","ima3-volume-changed":"ads-volumechange","ima3-paused":"ads-pause","ima3-resumed":"ads-play","ima3-skipped":"ads-ad-skipped","ima3-all-ads-completed":"ads-allpods-completed","ads-request":"ads-request","ads-pod-ended":"ads-pod-ended","ads-pod-started":"ads-pod-started","ads-load":"ads-load"},Ie=(e,t,a,n)=>{const i=function(i){e.trigger({type:n,emitter:t,originalEvent:i}),_e(e,n),"start"===a&&ge(e,"adBegin"),"skip"!==a&&"complete"!==a||ge(e,"adComplete");const o=we[n];if(o){const t={type:o};"ads-ad-started"!==o&&"ads-ad-ended"!==o||(t.indexInBreak=e.ads.ad.index),e.trigger(t)}};return t.addEventListener(a,i,!1),i},Ee=(e,t,a)=>{const n={},i=t.ima3._eventMapping.eventTypes;void 0===a&&(a=Ie);for(const o in i)n[o]=a(t,e,o,i[o]);return function(){for(const t in n)e.removeEventListener(t,n[t])}},Le=function(e){return"ima3-"+e.toLowerCase().replace(/_/g,"-")},Be=(e,t,a,n,i,o)=>{const r=oe(e);return()=>{t===a.ViewMode.FULLSCREEN?e.ima3.adsManager.resize(e.el().offsetWidth,e.el().offsetHeight,t):e.ima3.adsManager.resize(r.width,r.height,t),r.width===i&&r.height===o||n>=0&&setTimeout(Be(e,t,a,n-1,r.width,r.height),1e3)}},De=e=>{const t=e.textTracks();for(let e=0;e<t.length;e++)"metadata"===t[e].kind&&"disabled"===t[e].mode&&(t[e].mode="hidden")},Oe=e=>{e.on("fullscreenchange",(t=>{const n=window.google.ima;a.default.IS_ANY_SAFARI&&De(e);const i=e.hasClass("vjs-fullscreen");if(!e.ima3||!e.ima3.adsManager)return;const o=i?n.ViewMode.FULLSCREEN:n.ViewMode.NORMAL,r=oe(e);o===n.ViewMode.FULLSCREEN?e.ima3.adsManager.resize(e.el().offsetWidth,e.el().offsetHeight,o):e.ima3.adsManager.resize(r.width,r.height,o),setTimeout(Be(e,o,n,3,r.width,r.height),1e3)})),e.on("playerresize",(()=>{if(e.ima3.adsManager){const t=oe(e);e.ima3.adsManager.resize(t.width,t.height,window.google.ima.ViewMode.NORMAL)}}))},qe=(e,t)=>{const a=e.AdError.ErrorCode;for(const e in a)if(a.hasOwnProperty(e)&&!e.match("COMPANION|NONLINEAR|OVERLAY")&&t.getErrorCode()===a[e]&&"adLoadError"===t.getType())return!0;return!1},Ne=e=>{const t=e.ima3.adsManager;pe.isVast(t)?(e.ima3.log("[hardTimeout] Call util.destroyAdsManager for VAST ads."),pe.destroyAdsManager(e),e.trigger("ad-hard-timeout"),e.ima3.log("ima3-hard-timeout")):pe.isVmap(t)&&pe.includesPreroll(t)&&(e.ima3.log("[hardTimeout] Call adsManager.discardAdBreak for VMAP."),e.ima3.adsManager.discardAdBreak(),e.trigger("ad-hard-timeout"),e.ima3.log("ima3-hard-timeout"))},Ue=e=>{e.ima3.adDisplayContainer&&!e.ima3.adDisplayContainer.initialized&&(e.ima3.log("[initializeAdDisplayContainer] Call adDisplayContainer.initialize()."),e.ima3.adDisplayContainer.initialize(),e.ima3.adDisplayContainer.initialized=!0)},je=e=>{const t=window.google.ima,a=pe.getPlayerDimensions(e);e.ima3.log("[startAdsManager]");try{e.muted()&&e.ima3.adsManager.setVolume(0),Ue(e),e.trigger("ads-load"),e.ima3.log("[startAdsManager] trigger ads-load."),e.ima3.log("[startAdsManager] Call AdsManager.init()."),e.ima3.adsManager.init(a.width,a.height,t.ViewMode.NORMAL),e.ima3.log("[startAdsManager] Call AdsManager.start()."),e.ima3.adsManager.start()}catch(t){e.ima3.log("[startAdsManager] adError caught, trigger adserror."),e.ima3.log.warn("Error starting ads manager",t),e.trigger("adserror")}},Ve=e=>{e.ima3.adsManager.discardAdBreak(),e.ima3.adsManager.skip(),e.ima3.managerCleanup=null,e.ads.inAdBreak()&&e.ads.endLinearAdMode()},xe=(e,t)=>{if(t.ima3SdkSettings)for(const n in t.ima3SdkSettings){const i="set"+n.charAt(0).toUpperCase()+n.slice(1);"function"==typeof e.settings[i]?e.settings[i](t.ima3SdkSettings[n]):a.default.log.warn('Invalid ima3SdkSetting: "'+n+'"')}},Fe=(e,t,n)=>{const i=window.google.ima,o={};if(e.trigger({type:"ima3-ready",imaSdk:"ondemand"===t.requestMode?i:null}),e.ima3.log("[onSdkLoad]"),(e=>{e._eventMapping={},e.settings.eventMap=we;const t=window.google.ima,a={},n=["AdErrorEvent","AdEvent","AdsManagerLoadedEvent"];let i=n.length;for(;i--;){if(!t[n[i]]||!t[n[i]].Type)continue;const e=t[n[i]].Type;for(const t in e)e.hasOwnProperty(t)&&(a[e[t]]=Le(t))}e._eventMapping.eventTypes=a})(e.ima3),xe(i,t),t.vpaidMode){if("number"!=typeof i.ImaSdkSettings.VpaidMode[t.vpaidMode])throw new Error('Invalid VPAID Mode: "'+t.vpaidMode+'"');i.settings.setVpaidMode(i.ImaSdkSettings.VpaidMode[t.vpaidMode])}const r=e.el().querySelector(".vjs-tech");e.ima3.log("[onSdkLoad] Create ima.adDisplayContainer."),e.ima3.adDisplayContainer=new i.AdDisplayContainer(n,r,t.clickTrackingElement),e.ima3.adDisplayContainer.initialized=!1;let d="click";if((a.default.browser.IS_IOS||a.default.browser.IS_ANDROID)&&(d="touchend"),e.one(d,(()=>{Ue(e)})),e.ima3.log("[onSdkLoad] Create ima.AdsLoader."),e.ima3.adsLoader=new i.AdsLoader(e.ima3.adDisplayContainer),e.ima3.adsLoader){const t=e.ima3.adsLoader.getVersion();e.ima3.log("[onSdkLoad] IMA SDK Version: "+t)}const s=e.ima3.adsLoader.getSettings();s.setPlayerVersion(e.ima3.version),s.setPlayerType("brightcove/player-html5"),e.ima3.loaderCleanup=Ee(e.ima3.adsLoader,e);const l=e.currentSrc();pe.usingMediaCuepoints(t)&&((e,t,a)=>{e.ima3.log("[handleMediaCuepoints]"),e.ima3._loadstartSeen&&e.ima3.settings.serverUrl&&e.mediainfo?(e.ima3.log("[handleMediaCuepoints] Call createMediaCuepointVmap to set adRequestData.vmap if loadstart was previously seen."),a.vmap=Te(e)):e.ima3.oneUnlessContentUpdate_("loadstart",(()=>{e.ima3.log("[handleMediaCuepoints.oneUnlessContentUpdate.player.on] loadstart: Received loadstart event."),setTimeout((()=>{e.ima3.settings.serverUrl?(e.ima3.log("[handleMediaCuepoints.oneUnlessContentUpdate_] Call createMediaCuepointVmap to set adRequestData.vmap."),a.vmap=Te(e)):e.ima3.log.error("[handleMediaCuepoints.oneUnlessContentUpdate_] IMA3 serverUrl isnt provided.")}),0)}))})(e,0,o),((e,t,a)=>{if(e.ima3.log("[handleWaitForLoadstart]"),"ondemand"!==t.requestMode&&!pe.usingLiveAdCuepoints(t)){const t=()=>{e.mediainfo&&"FREE"===e.mediainfo.economics?(e.trigger("adscanceled"),e.trigger("nopreroll"),e.trigger("nopostroll")):(e.ima3.log("[handleWaitForLoadstart] Call adsRequest.requestAds with adRequestData.vmap after loadstart."),he.requestAds(e,null,a.vmap))};e.ima3._loadstartSeen?(e.ima3.log("[handleWaitForLoadstart] Call afterLoadStart if loadstart was seen."),t()):e.one("loadstart",(()=>{e.ima3.log("[handleWaitForLoadstart.player.on] loadstart: Received loadstart event."),setTimeout((()=>{e.ima3.log("[handleWaitForLoadstart.setTimeout] Call afterLoadStart on loadstart event."),t()}),0)}))}})(e,t,o),e.ima3.currentSrc_=e.currentSrc(),e.on("dispose",(()=>{e.ima3.log("[onSdkLoad.player.on] dispose: Call destroyAdsManager."),pe.destroyAdsManager(e),a.default._ima3sawDispose=!0})),e.on("contentchanged",(()=>{e.ima3.log("[onSdkLoad.player.on] contentchanged: Call handleContentChanged."),((e,t,a,n,i)=>{e.ima3.log("[handleContentChanged]"),setTimeout((()=>{if(a=e.currentSrc(),e.ima3.log("[handleContentChanged] Call util.destroyAdsManager on contentchanged event."),pe.destroyAdsManager(e),e.ima3._checkedForAdManagerStart=!1,e.ima3.lastSrc_=e.ima3.currentSrc_,e.ima3.currentSrc_=e.currentSrc(),pe.isEconomicsFree(e))return e.trigger("adscanceled"),e.trigger("nopreroll"),void e.trigger("nopostroll");"ondemand"!==t.requestMode?a&&""!==a&&"ondemand"!==t.requestMode&&!pe.usingLiveAdCuepoints(t)&&(pe.usingMediaCuepoints(t)&&(e.ima3.log("[handleContentChanged] Call mediaCuePoints.createMediaCuepointVmap to check current video cue point data and refresh ad VMAP"),n.vmap=Te(e)),e.ima3.log(`[handleContentChanged] ${n.vmap?"Call adRequest.requestAds":"No adRequestData.vmap data available, making adRequest.requestAds call"} with adRequestData.vmap =`,n.vmap),i.requestAds(e,null,n.vmap)):ye(e)}),0)})(e,t,l,o,he)}));const u=()=>{(e=>{e.ima3&&e.ima3.adsManager&&e.ima3.adsManager.skip&&e.ima3.adsManager.skip(),e.ima3.log("[postrollAdtimeoutHandler] Call util.destroyAdsManager."),pe.destroyAdsManager(e),e.trigger("ad-hard-timeout"),e.ima3.log("ima3-hard-timeout")})(e)};e.on("contentended",(()=>{e.ima3.log("[onSdkLoad.player.on] contentended: Call adsLoader.contentComplete."),e.one("adtimeout",u),e.ima3.adsLoader.contentComplete()})),e.on("contentupdate",(()=>{e.off("adtimeout",u),e.ima3.log("[onSdkLoad.player.on] contentupdate: Call adsLoader.contentComplete."),e.ima3.adsLoader.contentComplete()})),e.on(["contentupdate","adend","ima3-ready"],(()=>{"function"==typeof e.ads.ad.reset?e.ads.ad.reset():e.ads.ad={},"function"==typeof e.ads.pod.reset?e.ads.pod.reset():e.ads.pod={}})),e.ima3.el=n},He=e=>{const t=e.ima3.adsManager.getCuePoints(),a=t&&t.length>0,n=!(!e.ima3.adsRequest||!e.ima3.adsRequest.adsResponse);return pe.usingMediaCuepoints(e.ima3.settings)&&a&&!n},We=(e,t)=>{e.ima3.log("[onContentPauseRequested]"),"ondemand"===t.requestMode||pe.usingLiveAdCuepoints(t)||(e.ima3.log("[onContentPauseRequested] Call startLinearAdMode if requestmode not ondemand or not usingLiveAdCuepoints."),e.ads.startLinearAdMode()),a.default._ima3sawDispose&&!a.default._ima3adAfterDispose&&(e.trigger({type:"usage",name:"ima3-ad-after-dispose"}),a.default._ima3adAfterDispose=!0)},ze=e=>{e.ima3.log("[onContentResumeRequested]"),e.ads.inAdBreak()?(e.ima3.log("[onContentResumeRequested] Call endLinearAdMode if inAdBreak."),e.ads.endLinearAdMode(),e.removeClass("ima3-ad-loading"),e.removeClass("vjs-vpaid-playing"),e.trigger("ads-pod-ended")):(e.ima3.log("[onContentResumeRequested] Call skipLinearAdMode if not inAdBreak."),e.ads.skipLinearAdMode())},$e=e=>{let t="Non-fatal error occurred";if(e){const a=e.getErrorCode(),n=e.getMessage();a&&(t+=": AdError "+a),n&&(t+=": "+n)}return t},Qe=e=>{e.ima3.log("[onPluginInit]"),e.on("analytics_request",(t=>{e.ima3.log("[onPluginInit.player.on] analytics_request: "+t.params.event+" event triggered.")})),e.on(["ima3-ads-manager-loaded","ima3-ready","ima3-loaded","ima3-impression","ima3-viewable-impression","ima3-started","ima3-first-quartile","ima3-midpoint","ima3-third-quartile","ima3-skippable-state-changed","ima3-complete","ima3-all-ads-completed","ima3-ad-error","ima3-click","ima3-paused","ima3-resumed","ima3-content-pause-requested","ima3-content-resume-requested","ima3-skip","ima3-user-closed","ima3-linear-changed","ima3-ad-buffering","ima3-ad-metadata","ima3-interaction"],(t=>{e.ima3.log("[onPluginInit.player.on] IMA SDK Event "+t.type+" received.")})),e.on("adstart",(t=>{e.ima3.log("[onPluginInit.player.on] adstart: Received adstart event."),e.ads.shouldPlayContentBehindAd(e)||(e.ima3.log("[onPluginInit.player.on] adstart: Pause player if not LIVE and playing content behind ad."),e.pause()),e.hasStarted(!0),e.ima3.currentAdEventInfo={},"oncue"!==e.ima3.settings.requestmode&&e.duration()===1/0&&e.trigger({type:"usage",name:"ima3-live-preroll"})})),e.on("adend",(()=>{e.ima3.log("[onPluginInit.player.on] adend: Received adend event."),e.duration()===1/0&&e.trigger("playing")}))},Ge=(e,t)=>{const n=document.createElement("div");n.className="vjs-ima3-ad-container",e.ima3.insertAdContainer(n),e.ima3.adrequest=a=>{ve(a||t.serverUrl,e)},e.on("ima3-content-pause-requested",(a=>{e.ima3.log("[onPlayerReady.player.on] ima3-content-pause-requested: Received ON_CONTENT_PAUSE_REQUESTED event."),We(e,t)})),e.on("ima3-content-resume-requested",(t=>{e.ima3.log("[onPlayerReady.player.on] ima3-content-resume-requested: Received ON_CONTENT_RESUME_REQUESTED event."),e.ads.inAdBreak()&&ze(e)})),e.on("ima3-ad-break-fetch-error",(()=>{e.ima3.log("[onPlayerReady.player.on] ima3-ad-break-fetch-error: Received AD_BREAK_FETCH_ERROR event.");const t=()=>{e.ima3.log("[onPlayerReady.player.on] ima3-content-resume-requested: Received ON_CONTENT_RESUME_REQUESTED event."),e.ads.inAdBreak()||ze(e)};e.one("ima3-content-resume-requested",t),e.one("ima3-loaded",(()=>{e.off("ima3-content-resume-requested",t)}))})),Oe(e),e.on("ima3-started",(t=>{e.ima3.log("[onPlayerReady.player.on] ima3-started: Received STARTED event indicating ad has initiated playback."),e.removeClass("ima3-ad-loading"),e.ima3.log("ima3-started")})),e.on("ima3-log",(t=>{const a=t.originalEvent.getAdData().adError;e.ima3.log("ima3-log:",$e(a))})),e.on("ima3-ad-error",(t=>{e.ima3.log("[onPlayerReady.player.on] ima3-ad-error: Received AD_ERROR event.");let a,n={};t.originalEvent&&(n=t.originalEvent.getError(),a=n.getErrorCode(),e.ima3.log("ima3-ad-error",n.toString()),(qe(window.google.ima,n)&&"onload"===e.ima3.settings.requestMode||"onplay"===e.ima3.settings.requestMode)&&e.trigger("nopostroll")),e.removeClass("ima3-ad-loading"),e.trigger({type:"adserror",errorCode:a})})),e.on("ima3-all-ads-completed",(()=>{e.ended()||(e.ima3.log("[onPlayerReady.player.on] ima3-all-ads-completed: Ads completed before postroll"),e.trigger("nopostroll"))})),t.hardTimeouts&&e.on("adtimeout",(()=>{if(e.ima3.log("[onPlayerReady.player.on] adtimeout: Received adtimeout event"),e.ima3.adsManager)Ne(e);else{const t=()=>{Ne(e)};e.one("ima3-ads-manager-loaded",t),e.one(["adstart","contentupdate","dispose"],(a=>{e.off("ima3-ads-manager-loaded",t)}))}})),e.on("ima3-loaded",(t=>{e.ima3.log("[onPlayerReady.player.on] ima3-loaded: Received LOADED event indicating ad has loaded.");const a=t.originalEvent.getAd();e.ima3.log("[onPlayerReady.player.on] ima3-loaded: Ad",(e=>{const t=e.getAdPodInfo();return{id:e.getAdId(),adPodInfo:{adPosition:t.getAdPosition(),isBumper:t.getIsBumper(),maxDuration:t.getMaxDuration(),podIndex:t.getPodIndex(),timeOffset:t.getTimeOffset(),totalAds:t.getTotalAds()},adSystem:e.getAdSystem(),advertiserName:e.getAdvertiserName(),apiFramework:e.getApiFramework(),contentType:e.getContentType(),creativeAdId:e.getCreativeAdId(),creativeId:e.getCreativeId(),dealId:e.getDealId(),description:e.getDescription(),duration:e.getDuration(),height:e.getHeight(),width:e.getWidth(),isLinear:e.isLinear(),mediaUrl:e.getMediaUrl(),minSuggestedDuration:e.getMinSuggestedDuration(),skippable:e.isSkippable(),skipTimeOffSet:e.getSkipTimeOffset(),surveyUrl:e.getSurveyUrl(),title:e.getTitle(),universalAdIdRegistry:e.getUniversalAdIdRegistry(),universalAdIds:e.getUniversalAdIds().map((e=>({universalAdRegistry:e.getAdIdRegistry(),universalAdIdValue:e.getAdIdValue()}))),universalAdIdValue:e.getUniversalAdIdValue(),vastMediaBitrate:e.getVastMediaBitrate(),vastMediaHeight:e.getVastMediaHeight(),vastMediaWidth:e.getVastMediaWidth(),wrapperAdIds:e.getWrapperAdIds(),wrapperAdSystems:e.getWrapperAdSystems(),wrapperCreativeIds:e.getWrapperCreativeIds()}})(a)),e.trigger("ads-loading"),e.removeClass("ima3-ad-loading"),a&&!a.isLinear()&&(e.addClass("vjs-ima3-overlay"),e.ima3.log("[onPlayerReady.player.on] ima3-sdk-loaded: Call startLinearAdMode."),e.ads.startLinearAdMode(),e.ima3.log("[onPlayerReady.player.on] imad-sdk-loaded: Call endLinearAdMode."),e.ads.endLinearAdMode())})),e.on("ima3-complete",(t=>{e.ima3.log("[onPlayerReady.player.on] ima3-complete: Received COMPLETED event.");const a=t.originalEvent.getAd();e.ima3.log("ima3-complete"),delete e.ima3.currentAd,a&&(a.isLinear()?e.addClass("ima3-ad-loading"):e.removeClass("vjs-ima3-overlay"))})),e.on(["readyforpreroll","playing"],(n=>{e.ima3.log("[onPlayerReady.player.on] "+n.type+": Received "+n.type+" event"),(!a.default.browser.IS_ANY_SAFARI||"string"!=typeof e.autoplay()||"playing"!==n.type||e.ima3._checkedForAdManagerStart||e.ima3.adsManager)&&(e.ima3._checkedForAdManagerStart||(e.ima3._checkedForAdManagerStart=!0,!e.ima3.adsManager||pe.usingLiveAdCuepoints(t)||"ondemand"===t.requestMode||pe.isEconomicsFree(e)||(e.ima3.log("[onPlayerReady.player.on] "+n.type+": Call startAdsManager for onload or onplay requestmodes."),je(e))))})),e.on("adserror",(()=>{e.ima3.log("[onPlayerReady.player.on] adserror: Received ADS_ERROR event."),e.ima3.log("[onPlayerReady.player.on] adserror: Call destroyAdsManager"),pe.destroyAdsManager(e)})),e.on("adscanceled",(()=>{e.ima3.log("[onPlayerReady.player.on] adscanceled: Received ADS_CANCELED event."),e.ima3.log("[onPlayerReady.player.on] adscanceled: Call destroyAdsManager."),pe.destroyAdsManager(e)})),e.on("ima3-ads-manager-loaded",(t=>{e.ima3.log("[onPlayerReady.player.on] ima-ads-manager-loaded: Received LOADED event."),((e,t)=>{e.ima3.log("[onAdsManagerLoaded]"),e.ima3.managerCleanup&&(e.ima3.log("[onAdsManagerLoaded] Call destroyAdsManager."),pe.destroyAdsManager(e));const a={currentTime:e.currentTime(),duration:e.duration()};e.on("timeupdate",(()=>{a.currentTime=e.currentTime()}));const n=t.originalEvent.getAdsManager(a,e.ima3.adsRenderingSettings_);e.ima3.adsManager=n,e.trigger("ads-response-received");const i=e.ima3.settings;if(He(e))return Ve(e),void e.ima3.log.error("Cancelling VMAP ad because thead server cannot return a vmap when using cuepoints");e.ima3.managerCleanup=Ee(n,e),"ondemand"===i.requestMode||"oncue"===i.requestMode?(e.ima3.log("[onAdsManagerLoaded] Call startAdsManager if requestMode equals ondemand or oncue."),je(e)):e.trigger("adsready"),"oncue"!==i.requestMode&&(pe.includesPreroll(n)||e.trigger("nopreroll"),pe.includesPostroll(n)||e.trigger("nopostroll"))})(e,t)})),a.default.use&&!a.default._imaMiddlewareSetup&&(a.default.log.debug("Setting up IMA middleware"),a.default.use("*",(e=>({setSource:(t,a)=>{if(e&&e.ads&&"function"==typeof e.ads.inAdBreak&&e.ads.inAdBreak()&&(e.ima3.adsManager.discardAdBreak(),e.ads.disableNextSnapshotRestore=!0,e.ads.endLinearAdMode(),e.trigger("contentresumed"),e.autoplay())){const t=e.play();t&&t.catch&&t.catch((()=>{}))}a(null,t)}}))),a.default._imaMiddlewareSetup=!0),window.google&&window.google.ima?Fe(e,t,n):pe.loadScript(t.sdkurl,(a=>{if(a)return e.trigger("nopreroll"),e.trigger("nopostroll"),e.trigger({type:"adserror",error:a});Fe(e,t,n)}))},Ye=/^(file|data):/.test(window.location.protocol)?"http:":window.location.protocol,Je={sdkurl:`${Ye}//imasdk.googleapis.com/js/sdkloader/ima3.js`,serverUrl:`${Ye}//pubads.g.doubleclick.net/gampad/ads?sz=400x300&iu=%2F6062%2Fiab_vast_samples&ciu_szs=300x250%2C728x90&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]&cust_params=iab_vast_samples%3Dlinear`,timeout:4e3,requestMode:"onload",hardTimeouts:!0,showVpaidControls:!1,debug:!1};a.default.ima3={extend:se};const Ke=function(e){const t=((e,t={})=>{const a=se({},Je,t);if(e.ima3.defaults=Je,t.useMediaCuePoints&&"oncue"!==t.requestMode)throw new Error(`useMediaCuePoints must be used with requestMode "oncue" rather than the currently set ${t.requestMode}`);return"onplay"===a.requestMode&&e.autoplay()&&(a.requestMode="onload"),a.timeout&&(a.prerollTimeout=a.postrollTimeout=a.timeout),a.contribAdsPrerollTimeout&&(a.prerollTimeout=a.contribAdsPrerollTimeout),a.contribAdsPostrollTimeout&&(a.postrollTimeout=a.contribAdsPostrollTimeout),"function"==typeof e.debug&&e.debug()&&(a.debug=!0),a.debug&&!t.hasOwnProperty("sdkurl")&&(a.sdkurl=`${Ye}//imasdk.googleapis.com/js/sdkloader/ima3_debug.js`),a.liveCuePoints="oncue"===a.requestMode,a})(this,e),n=this.getChild("ControlBar"),i=n&&n.getChild("PlaybackRateMenuButton"),o=i&&i.hasClass("vjs-hidden");let r;e&&e.hasOwnProperty("asyncAutoplaySupport")&&a.default.log.warn("Brightcove IMA3: The asyncAutoplaySupport option no longer has any effect. We recommend removing it."),!1!==this.autoplay()&&(t.allowVjsAutoplay=!0,this.addClass("vjs-ima3-not-playing-yet"),this.any(["autoplay-success","autoplay-failure"],(e=>{"autoplay-success"!==e.type||this.ima3._adsErrorSeen||this.pause(),this.removeClass("vjs-ima3-not-playing-yet"),this.ima3._autoplayResultEvent=e})),a.default.browser.IS_IOS||a.default.browser.IS_ANDROID||this.addClass("vjs-ima3-autoplay")),t.showVpaidControls||this.addClass("vjs-vpaid-controls-disabled"),this.addClass("vjs-ad-controls"),this.on("ima3-content-pause-requested",(e=>{this.addClass("ima3-ad-loading"),this.trigger("ads-pod-started"),"application/javascript"===e.originalEvent.getAd().getContentType()&&this.addClass("vjs-vpaid-playing")})),this.on("ima3-skipped",(()=>{this.ads.ad.skipped=1})),this.on("ima3-click",(()=>{this.ads.ad.interaction=1})),this.on(["ima3-complete","ima3-ad-error","ima3-content-resume-requested"],(e=>{const t=n.getChild("ProgressControl").getChild("SeekBar").getChild("PlayProgressBar");n.removeClass("vjs-ad-control-bar"),t.hasClass("vjs-play-progress-resetting")||t.addClass("vjs-play-progress-resetting"),t.el().style.width="0",a.default.browser.IS_IOS&&(i&&!o&&i.show(),this.one("contentplayback",(()=>{this.one("playing",(()=>{r&&this.playbackRate(r)}))})))})),this.on(["ima3-complete","ima3-ad-error","ima3-content-resume-requested","adend"],(()=>{this.ima3.el.style.removeProperty("pointer-events")})),this.on("ads-request",(function(){const e=Date.now();this.one("ima3-ads-manager-loaded",(function(){this.ads.pod.request_ms=Date.now()-e}))})),this.on("ima3-loaded",(e=>{const t=Date.now();this.one("ima3-started",(()=>{const e=Date.now();this.ads.ad.start_ms=e-t}))})),this.on("ima3-started",(e=>{const t=n.getChild("ProgressControl").getChild("SeekBar").getChild("PlayProgressBar");if(t.el().style.width="0",n.hasClass("vjs-ad-control-bar")||n.addClass("vjs-ad-control-bar"),t.removeClass("vjs-play-progress-resetting"),a.default.browser.IS_IOS&&(i&&!o&&i.hide(),1!==this.playbackRate()&&(r=this.playbackRate()),this.playbackRate(1)),this.ima3.currentAd=e.originalEvent.getAd(),this.ads.ad.skipped=0,this.ads.ad.interaction=0,this.ima3.currentAd.isSkippable()){this.ima3.el.style.setProperty("pointer-events","auto")}})),this.on(["adstart","adend"],(e=>{const{pod:t}=this.ads,{adTagUrl:a}=this.ima3.adsRequest||{};if("string"==typeof a){let e="";try{e=new URL(a).host}catch(e){this.ima3.log.error(e)}pe.assignIfTruthy(t,"host",e)}pe.assignIfTruthy(t,"request_mode",this.ima3.settings&&this.ima3.settings.requestMode),i&&!o&&("adstart"===e.type?i.hide():i.show())})),this.on("ima3-ad-progress",(()=>{this.trigger("timeupdate")})),this.on("adserror",(()=>{this.ima3._adsErrorSeen=!0})),this.on(["dispose","contentchanged"],(()=>{var e;(e=this).ima3._loadstartSeen=!1,e.ima3._playSeen=!1,e.ima3._adsErrorSeen=!1,e.ima3._autoplayResultEvent=void 0,void 0!==e.ima3._requestAdsOnPlay&&e.off("play",e.ima3._requestAdsOnPlay)})),this.on("loadstart",(()=>{this.ima3._loadstartSeen=!0})),this.on("play",(()=>{this.ima3._playSeen=!0})),this.on("contentchanged",(()=>{this.pause(),this.ads.settings.allowVjsAutoplay=!1,this.ima3._contentchangedSeen=!0,this.playlist&&ce(this.playlist.autoadvance_)&&this.one("adsready",(()=>{this.ima3.log("[onAdsReady.player.on] Autoadvance setting detected, calling play() to initiate playback after BeforePreroll state"),this.play()}))})),this.on("adtimeout",(()=>{this.playlist&&ce(this.playlist.autoadvance_)&&this.one("contentchanged",(()=>{this.ima3.log("[onAdsReady.player.on] Autoadvance setting detected, calling play() to initiate playback after ad timeout"),this.play()}))})),this.ads(t),this.ads.ad=this.adDataStore&&this.adDataStore.adData||{},this.ads.ad.skipped=0,this.ads.ad.interaction=0,this.ads.pod=this.adDataStore&&this.adDataStore.podData||{},this.contribAds6Shim(a.default.mergeOptions({},t.contribAds6Shim||{})),"oncue"===t.requestMode?Z.init(this,t):"ondemand"===t.requestMode&&ye(this),this.ima3=ke(this,t),Qe(this),this.ready((()=>{const e=a.default.getTech("Html5");if(!e||!e.isSupported())throw new Error("Html5 is not available on this platform.");Ge(this,t),this.addClass("vjs-ima3-html5")}),!0)};Ke.version=Re,Ke.VERSION=Re,function(e){if(ne("ima3"))return!1;const t=ne("ads");(function(e,t){const a=te(e),n=t?te(t):ae;return!(!n||!a||a[0]!==n[0]||a[1]<n[1]||!(a[1]>n[1]||a[2]>=n[2]))})(t.VERSION)||a.default.log.error(`The IMA plugin depends on contrib-ads version "${ae}", but it saw version "${t.VERSION}". This is not a compatible configuration. The IMA plugin will attempt to continue initializing, but this problem should be addressed. If you are using ad failover, please select compatible versions of the SSAI and IMA plugins.`),a.default.use("*",ee),(a.default.registerPlugin||a.default.plugin)("ima3",e)}(Ke)}));
